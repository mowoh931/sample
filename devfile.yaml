schemaVersion: 2.1.0
metadata:
  name: sample-app
projects:
  - name: sample-app
    source:
      type: git
      location: "https://github.com/mowoh931/sample.git"
components:
  - name: tools
    container:
      image: quay.io/eclipse/che-java11-maven:nightly
      memoryLimit: 512Mi
      mountSources: true
      endpoints:
        - name: http-8080
          targetPort: 8080
  - name: sample-app
    container:
      image: openjdk:17-jdk-alpine
      memoryLimit: 512Mi
      mountSources: true
      command: ["sh", "-c"]
      args: ["mvn clean install && java -jar target/sample-app-0.0.1-SNAPSHOT.jar"]
      endpoints:
        - name: http-8080
          targetPort: 8080
commands:
  - id: build
    exec:
      component: tools
      commandLine: "mvn clean install"
      workingDir: "/projects/sample-app"
  - id: run
    exec:
      component: sample-app
      commandLine: "java -jar target/sample-app-0.0.1-SNAPSHOT.jar"
      workingDir: "/projects/sample-app"
      group:
        kind: run
        isDefault: true